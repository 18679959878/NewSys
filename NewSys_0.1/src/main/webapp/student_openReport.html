<!DOCTYPE html>
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<title>软件动漫学院准毕业生毕业设计与实习管理系统</title>
<link rel="stylesheet" href="css/style.css">
<link rel="stylesheet" href="css/jquery.wysiwyg.old-school.css">
<link rel="stylesheet" href="css/tip.css" />
<link rel="stylesheet" href="css/sumbitButton.css">
<!-- jQuery AND jQueryUI -->
<script type="text/javascript" src="js/msgbox.js"></script>
<script type="text/javascript" src="js/jquery.min.js"></script>
<script type="text/javascript" src="js/jquery-ui.min.js"></script>
<script type="text/javascript" src="js/min.js"></script>
<!--<script type="text/javascript" src="js/index.js"></script>-->
<script type="text/javascript" src="js/main.js"></script>
<script type="text/javascript" src="js/url.js"></script>
<link rel="stylesheet" href="css/style2.css">
<script type="text/javascript" src="js/wangEditor.min.js"></script>
<script>"undefined"==typeof CODE_LIVE&&(!function(e){var t={nonSecure:"54645",secure:"54650"},c={nonSecure:"http://",secure:"https://"},r={nonSecure:"127.0.0.1",secure:"gapdebug.local.genuitec.com"},n="https:"===window.location.protocol?"secure":"nonSecure";script=e.createElement("script"),script.type="text/javascript",script.async=!0,script.src=c[n]+r[n]+":"+t[n]+"/codelive-assets/bundle.js",e.getElementsByTagName("head")[0].appendChild(script)}(document),CODE_LIVE=!0);</script></head>
<body data-genuitec-lp-enabled="false" data-genuitec-file-id="wc1-73" data-genuitec-path="/NewSys Maven Webapp/src/main/webapp/student_openReport.html">

	<!--     内容      -->
	<div id="content" class="white" data-genuitec-lp-enabled="false" data-genuitec-file-id="wc1-73" data-genuitec-path="/NewSys Maven Webapp/src/main/webapp/student_openReport.html">
		<h1>
			<img src="images/posts.png" alt="">毕业设计（论文）开题报告
		</h1>

		<!--操作栏-->
		<div class="bloc">
			<div class="title">
				操作 <a class="toggle"></a>
			</div>
			<div class="content dashboard">
				<div class="center" style="display: block; width: auto;">
					<a href="student_openReport.html" id="refurbish" class="shortcut">
						<img src="images/refurbish.png" alt="" width="48" height="48">
						刷新页面
					</a>
					<div class="cb"></div>
				</div>
			</div>
		</div>


		<div class="bloc">
			<div class="title">
				毕业设计（论文）开题报告 <a
					href="http://www.grafikart.fr/demo/coreadmin/index.php?p=table#"
					class="toggle"></a>
			</div>
			<div class="content">
				<form method="post" action="/NewSys/or/sop" id="add">
					<h1>毕业设计（论文）开题报告</h1>
					<div id="basisAndSignificance" class="editor">
						<h5>选题依据及研究意义</h5>
						<p style="font-size: 16px;">选题依据</p>
						<br> <br> <br>
						<p style="font-size: 16px;">研究意义</p>

					</div>
					<div style="height: 40px;">
						<p style="margin-left: 92%; font-size: 16px;">

							<span class="message" style="color: red;"></span>
						</p>
					</div>
					<div id="situation" class="editor">
						<h5>选题研究现状</h5>
					</div>
					<div style="height: 40px;">
						<p style="margin-left: 92%; font-size: 16px;">

							<span class="message" style="color: red;"></span>
						</p>
					</div>

					<div id="researchContent" class="editor">
						<h5>研究内容(包括基本思路、框架、主要研究方式、方法等)</h5>
						<p style="font-size: 16px;">研究内容</p>
						<br> <br> <br>
						<p style="font-size: 16px;">研究基本思路</p>
						<br> <br> <br>
						<p style="font-size: 16px;">研究框架图（插入图片，请删除括号内内容）</p>
						<br> <br> <br>
						<p style="font-size: 16px;">研究方式、方法</p>
					</div>
					<div style="height: 40px;">
						<p style="margin-left: 92%; font-size: 16px;">

							<span class="message" style="color: red;"></span>
						</p>
					</div>
					<div id="proposal" class="editor">
						<h5>论文提纲（含论文选题、论文主体框架）</h5>
					</div>
					<div style="height: 40px;">
						<p style="margin-left: 92%; font-size: 16px;">

							<span class="message" style="color: red;"></span>
						</p>
					</div>
					<div id="literature" class="editor">
						<h5>主要参阅文献</h5>
					</div>
					<div style="height: 40px;">
						<p style="margin-left: 92%; font-size: 16px;">

							<span class="message" style="color: red;"></span>
						</p>
					</div>
					<div id="otherInstructions" class="editor">
						<h5>其他说明</h5>
						<br> <br> <br>
						<p style="font-size: 16px;">选择研究课题为：</p>
					</div>
					<div style="height: 40px;">
						<p style="margin-left: 92%; font-size: 16px;">

							<span class="message" style="color: red;"></span>
						</p>
					</div>
					<div id="agree" class="editor">
						<h5>指导老师是否同意开题：</h5>
						<br> <br> <br>
					</div>
					<textarea id="basisAndSignificance_t" name="basisAndSignificance"
						hidden="hidden"></textarea>
					<textarea id="situation_t" name="situation" hidden="hidden"></textarea>
					<textarea id="researchContent_t" name="researchContent"
						hidden="hidden"></textarea>
					<textarea id="proposal_t" name="proposal" hidden="hidden"></textarea>
					<textarea id="literature_t" name="literature" hidden="hidden"></textarea>
					<textarea id="otherInstructions_t" name="otherInstructions"
						hidden="hidden"></textarea>
					<textarea id="agree_t" name="agree" hidden="hidden"></textarea>

				</form>
				<button id="but" onclick="tip()">提&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;交</button>
			</div>
		</div>
	</div>

	<br>
	<div id="ui-datepicker-div"
		class="ui-datepicker ui-widget ui-widget-content ui-helper-clearfix ui-corner-all"></div>
</body>
<script type="text/javascript">
	var editors = new Array();
	var isLock = false;
	function tip() {
		if (isLock == false) {
			$("#basisAndSignificance_t").val(editors[0].txt.html());
			if (removeHTMLTag(editors[0].txt.html()).length > 500) {
				var tip = "保存失败，[选题依据及研究意义]" + removeHTMLTag(editors[0].txt.html()).length + "字,超过500字限制";
				ZENG.msgbox.show(tip, 5, 2000);
				return;
			}
			$("#situation_t").val(editors[1].txt.html());
			if (removeHTMLTag(editors[1].txt.html()).length > 550) {
				var tip = "，保存失败，[选题研究现状]" + removeHTMLTag(editors[1].txt.html()).length + "字,超过550字限制";
				ZENG.msgbox.show(tip, 5, 2000);
				return;
			}
			$("#researchContent_t").val(editors[2].txt.html());
			if (removeHTMLTag(editors[2].txt.html()).length > 1000) {
				var tip = "，保存失败，[研究内容]" + removeHTMLTag(editors[2].txt.html()).length + "字,超过1000字限制";
				ZENG.msgbox.show(tip, 5, 2000);
				return;
			}
			$("#proposal_t").val(editors[3].txt.html());
			if (removeHTMLTag(editors[3].txt.html()).length > 500) {
				var tip = "，保存失败，[论文提纲]" + removeHTMLTag(editors[3].txt.html()).length + "字,超过500字限制";
				ZENG.msgbox.show(tip, 5, 2000);
				return;
			}
			$("#literature_t").val(editors[4].txt.html());
			if (removeHTMLTag(editors[4].txt.html()).length > 450) {
				var tip = "，保存失败，[主要参阅文献]" + removeHTMLTag(editors[4].txt.html()).length + "字,超过450字限制";
				ZENG.msgbox.show(tip, 5, 2000);
				return;
			}
			$("#otherInstructions_t").val(editors[5].txt.html());
			if (removeHTMLTag(editors[5].txt.html()).length > 120) {
				var tip = "，保存失败，[其他说明]" + removeHTMLTag(editors[5].txt.html()).length + "字,超过120字限制";
				ZENG.msgbox.show(tip, 5, 2000);
				return;
			}
			$("#agree_t").val(editors[6].txt.html());
			var targetUrl = $("#add").attr("action");
			var sendData = $("#add").serialize();
			$.ajax({
				url : targetUrl,
				type : 'POST', //POST
				timeout : 5000, //超时时间
				data : sendData,
				dataType : 'json', //返回的数据格式：json/xml/html/script/jsonp/text
				success : function(data) {
					if (data.success == true) {
						var tip = "内容已保存";
						ZENG.msgbox.show(tip, 4, 2000);
					} else {
						var tip = data.error;
						ZENG.msgbox.show(tip, 5, 2000);
					}
				},
				error : function(data) {
					var tip = "内容保存失败";
					ZENG.msgbox.show(tip, 5, 2000);
				}
			});
		} else {
			var tip = "内容被锁定，无法保存";
			ZENG.msgbox.show(tip, 5, 2000);
		}
	}
</script>
<script type="text/javascript">

	//$("#liberature_t").val(liberature.txt.html());
	function removeHTMLTag(str) {
		str = str.replace(/<\/?[^>]*>/g, ''); //去除HTML tag
		str = str.replace(/[ | ]*\n/g, '\n'); //去除行尾空白
		str = str.replace(/&nbsp;/ig, ''); //去掉&nbsp;
		return str;
	}
	function createData(editors) {
		$.ajax({
			url : "/NewSys/or/sel",
			type : 'GET',
			timeout : 5000, //超时时间
			dataType : 'json', //返回的数据格式：json/xml/html/script/jsonp/text
			success : function(data) {
				if (data.success) {
					editors[0].txt.html(data.data.basisAndSignificance);
					editors[1].txt.html(data.data.situation);
					editors[2].txt.html(data.data.researchContent);
					editors[3].txt.html(data.data.proposal);
					editors[4].txt.html(data.data.literature);
					editors[5].txt.html(data.data.otherInstructions);
					editors[6].txt.html(data.data.agree);
					isLock = data.data.isLock;
					if (data.data.isLcock == true) {
						$("#but").css("background", "#C0C0C0");
						$("#but").html("已&nbsp;&nbsp;锁&nbsp;&nbsp;&nbsp;定");
					} else {
						$("#but").css("background", "");
						$("#but").html("提&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;交");
					}
				}
			}
		});
	}
	//createData(liberature);
</script>
<script type="text/javascript">
	var E = window.wangEditor;
	var nums = 0;
	editors[0] = new E("#basisAndSignificance");
	editors[1] = new E("#situation");
	editors[2] = new E("#researchContent");
	editors[3] = new E("#proposal");
	editors[4] = new E("#literature");
	editors[5] = new E("#otherInstructions");
	editors[6] = new E("#agree");
	for (var i = 0; i < editors.length; i++) {
		if (i == 2) {
			editors[i].customConfig.menus = [
				'head', // 标题
				'bold', // 粗体
				'fontSize', // 字号
				'fontName', // 字体
				'underline', // 下划线
				'strikeThrough', // 删除线
				'list', // 列表
				'justify', // 对齐方式
				'quote', // 引用
				'table', // 表格
				'image', // 插入图片
				'code', // 插入代码
				'undo', // 撤销
				'redo' // 重复

			];
			editors[i].customConfig.uploadImgServer = '/NewSys/photo/wangEditorUpload';
			editors[i].customConfig.uploadFileName = 'photo';
		} else {
			editors[i].customConfig.menus = [
				'head', // 标题
				'fontSize',
				'list',
				'justify',
				'undo',
				'redo',
				'bold', // 粗体
				'code' // 插入代码
			];
		}
		editors[i].customConfig.onchange = function(html) {
			//	$("#contentAndRequired_t").val(html);
			var length = removeHTMLTag(html).length;
			if ((length - nums >= 20) || (length - nums <= -20)) {
				nums = length;
				tip();
			}
		}

		editors[i].create();
		if (i == 6) {
			editors[i].$textElem.attr('contenteditable', false);
		}
	}
	createData(editors);
</script>
<br>
</html>

